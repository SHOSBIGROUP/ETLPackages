<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="1/25/2019 2:23:17 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="LT-MPLASKO"
  DTS:CreatorName="SHO\mplaskow"
  DTS:DTSID="{FE99AC81-FDAD-4A2E-8192-F712CA8F955E}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="14.0.3002.107"
  DTS:LocaleID="1033"
  DTS:ObjectName="LOAD_NS_SALES_RAW_to_HISTORY"
  DTS:PackageType="5"
  DTS:VersionBuild="21"
  DTS:VersionGUID="{8350BFC4-5AD2-40E2-92D9-245D0C5B0782}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Insert Into netsuite_sales_daily_header_history"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{234c1a03-3a08-4fde-96a6-3013b38ffc67}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Insert Into netsuite_sales_daily_header_history"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{70e1c0af-32b1-4003-bbb8-6f11bcf67768}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="--*** Insert Into netsuite_sales_daily_header_history ***&#xA;Insert Into sho_staging.netsuite.sales_daily_header_history(&#xA;[internal_id],&#xA;[create_date],&#xA;[transaction_type],&#xA;[transaction_status],&#xA;[transaction_source],&#xA;[document_number],&#xA;[sales_check_number],&#xA;[accounting_unit_nohierarchy],&#xA;[store_format_type],&#xA;[region],&#xA;[district],&#xA;[store],&#xA;[location_no_hierarchy],&#xA;[net_amt],&#xA;[total_amount],&#xA;[total_tax],&#xA;[shipping_amount],&#xA;[amount],&#xA;[amount_remaining],&#xA;[gross_profit],&#xA;[comp_store_flag],&#xA;[customer_first_name],&#xA;[customer_last_name],&#xA;[customer_address_1],&#xA;[customer_address_2],&#xA;[customer_city],&#xA;[customer_state],&#xA;[customer_zip],&#xA;[customer_email_1],&#xA;[customer_alt__email],&#xA;[customer_acc_email],&#xA;[customer_shipping_email],&#xA;[customer_phone],&#xA;[customer_mobile],&#xA;[customer_home_phone],&#xA;[date_last_modified],&#xA;[created_from_type],&#xA;[created_from_document],&#xA;[amount_net_of_tax],&#xA;[created_from_invoice],&#xA;[created_from_so],&#xA;[subtotal],&#xA;[discount_amount],&#xA;[shipping_cost],&#xA;[gift_certificate_amount],&#xA;[sho_syw_memberid],&#xA;[sales_rep],&#xA;[rec_load_dt],&#xA;[filename]&#xA;) Select &#xA;Convert(varchar(8),[internal_id]),&#xA;Convert(varchar(28),[create_date]),&#xA;Convert(varchar(20),[transaction_type]),&#xA;Convert(varchar(20),[transaction_status]),&#xA;Convert(varchar(27),[transaction_source]),&#xA;Convert(varchar(18),[document_number]),&#xA;Convert(varchar(50),[sales_check_number]),&#xA;Convert(varchar(14),[accounting_unit_nohierarchy]),&#xA;Convert(varchar(14),[store_format_type]),&#xA;Convert(varchar(14),[region]),&#xA;Convert(varchar(14),[district]),&#xA;Convert(varchar(14),[store]),&#xA;Convert(varchar(14),[location_no_hierarchy]),&#xA;Convert(varchar(20),[net_amt]),&#xA;Convert(varchar(20),[total_amount]),&#xA;Convert(varchar(20),[total_tax]),&#xA;Convert(varchar(20),[shipping_amount]),&#xA;Convert(varchar(20),[amount]),&#xA;Convert(varchar(20),[amount_remaining]),&#xA;Convert(varchar(20),[gross_profit]),&#xA;Convert(varchar(11),[comp_store_flag]),&#xA;Convert(varchar(50),[customer_first_name]),&#xA;Convert(varchar(50),[customer_last_name]),&#xA;Convert(varchar(100),[customer_address_1]),&#xA;Convert(varchar(100),[customer_address_2]),&#xA;Convert(varchar(50),[customer_city]),&#xA;Convert(varchar(12),[customer_state]),&#xA;Convert(varchar(10),[customer_zip]),&#xA;Convert(varchar(100),[customer_email_1]),&#xA;Convert(varchar(100),[customer_alt__email]),&#xA;Convert(varchar(100),[customer_acc_email]),&#xA;Convert(varchar(100),[customer_shipping_email]),&#xA;Convert(varchar(20),[customer_phone]),&#xA;Convert(varchar(20),[customer_mobile]),&#xA;Convert(varchar(22),[customer_home_phone]),&#xA;Convert(varchar(255),[date_last_modified]),&#xA;Convert(varchar(255),[created_from_type]),&#xA;Convert(varchar(255),[created_from_document]),&#xA;Convert(varchar(20),[amount_net_of_tax]),&#xA;Convert(varchar(255),[created_from_invoice]),&#xA;Convert(varchar(255),[created_from_so]),&#xA;Convert(varchar(20),[subtotal]),&#xA;Convert(varchar(20),[discount_amount]),&#xA;Convert(varchar(20),[shipping_cost]),&#xA;Convert(varchar(20),[gift_certificate_amount]),&#xA;Convert(varchar(26),[sho_syw_memberid]),&#xA;Convert(varchar(41),[sales_rep]),&#xA;GETDATE(),&#xA;Convert(varchar(255),[filename])&#xA; From sho_staging.netsuite.sales_daily_header_raw r&#xA; where NOT EXISTS &#xA; (&#xA;&#x9;SELECT [document_number]&#xA;&#x9;FROM sho_staging.netsuite.sales_daily_header_history h&#xA;&#x9;WHERE trim(r.[document_number]) = trim(h.[document_number]) &#xA;&#x9;and trim(r.[create_date]) = trim(h.[create_date])&#xA; );"
          SQLTask:TypeConversionMode="None" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Insert Into netsuite_sales_daily_line_history"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{27092722-6973-4c61-985b-0fe47853a064}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Insert Into netsuite_sales_daily_line_history"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="3">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{70e1c0af-32b1-4003-bbb8-6f11bcf67768}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="--*** Insert Into [netsuite].[sales_daily_line_history]  from new records in [sho_staging].[netsuite].[sales_daily_line_raw] ***&#xA;Insert Into sho_staging.netsuite.sales_daily_line_history&#xA;(&#xA;[create_date],&#xA;[transaction_type],&#xA;[transaction_status],&#xA;[transaction_source],&#xA;[document_number],&#xA;[sales_check_number],&#xA;[accounting_unit],&#xA;[store_format_type],&#xA;[region],&#xA;[district],&#xA;[store],&#xA;[location_no_hierarchy],&#xA;[category],&#xA;[division],&#xA;[line],&#xA;[subline],&#xA;[class],&#xA;[item_name],&#xA;[item_description_display_name],&#xA;[item_designation],&#xA;[sku_number],&#xA;[sho_item_type],&#xA;[brand],&#xA;[available_pa],&#xA;[bulk_sales],&#xA;[net_amt],&#xA;[net_qty],&#xA;[item_average_cost],&#xA;[list_price],&#xA;[regular_price],&#xA;[cadence_price_3h],&#xA;[cadance_price_outlet],&#xA;[sold_price],&#xA;[gross_profit],&#xA;[comp_store_flag],&#xA;[fulfillment_method],&#xA;[fulfillment_option_selected],&#xA;[first_name],&#xA;[last_name],&#xA;[address_1],&#xA;[address_2],&#xA;[city],&#xA;[state],&#xA;[zip],&#xA;[email_1],&#xA;[email_2],&#xA;[email_3],&#xA;[email_4],&#xA;[phone_number1],&#xA;[phone_number2],&#xA;[phone_number3],&#xA;[line_sequence_number],&#xA;[amount_tax],&#xA;[upc_code],&#xA;[created_from_type],&#xA;[line_last_modified],&#xA;[fulfilled_received_line_level],&#xA;[created_from_document],&#xA;[line_unique_key],&#xA;[created_from_invoice],&#xA;[created_from_so],&#xA;[rec_load_dt],&#xA;[rec_upd_dt],&#xA;[filename]&#xA;) &#xA;Select &#xA;Convert(varchar(28),[create_date]),&#xA;Convert(varchar(20),[transaction_type]),&#xA;Convert(varchar(20),[transaction_status]),&#xA;Convert(varchar(27),[transaction_source]),&#xA;Convert(varchar(18),[document_number]),&#xA;Convert(varchar(60),[sales_check_number]),&#xA;Convert(varchar(80),[accounting_unit]),&#xA;Convert(varchar(13),[store_format_type]),&#xA;Convert(varchar(14),[region]),&#xA;Convert(varchar(13),[district]),&#xA;Convert(varchar(14),[store]),&#xA;Convert(varchar(14),[location_no_hierarchy]),&#xA;Convert(varchar(50),[category]),&#xA;Convert(varchar(50),[division]),&#xA;Convert(varchar(50),[line]),&#xA;Convert(varchar(50),[subline]),&#xA;Convert(varchar(50),[class]),&#xA;Convert(varchar(50),[item_name]),&#xA;Convert(varchar(71),[item_description_display_name]),&#xA;Convert(varchar(31),[item_designation]),&#xA;Convert(varchar(13),[sku_number]),&#xA;Convert(varchar(36),[sho_item_type]),&#xA;Convert(varchar(36),[brand]),&#xA;Convert(varchar(100),[available_pa]),&#xA;Convert(varchar(11),[bulk_sales]),&#xA;Convert(varchar(18),[net_amt]),&#xA;Convert(varchar(12),[net_qty]),&#xA;Convert(varchar(23),[item_average_cost]),&#xA;Convert(varchar(17),[list_price]),&#xA;Convert(varchar(17),[regular_price]),&#xA;Convert(varchar(16),[cadence_price_3h]),&#xA;Convert(varchar(16),[cadance_price_outlet]),&#xA;Convert(varchar(18),[sold_price]),&#xA;Convert(varchar(18),[gross_profit]),&#xA;Convert(varchar(11),[comp_store_flag]),&#xA;Convert(varchar(40),[fulfillment_method]),&#xA;Convert(varchar(40),[fulfillment_option_selected]),&#xA;Convert(varchar(33),[first_name]),&#xA;Convert(varchar(40),[last_name]),&#xA;Convert(varchar(40),[address_1]),&#xA;Convert(varchar(19),[address_2]),&#xA;Convert(varchar(50),[city]),&#xA;Convert(varchar(12),[state]),&#xA;Convert(varchar(18),[zip]),&#xA;Convert(varchar(50),[email_1]),&#xA;Convert(varchar(50),[email_2]),&#xA;Convert(varchar(50),[email_3]),&#xA;Convert(varchar(50),[email_4]),&#xA;Convert(varchar(20),[phone_number1]),&#xA;Convert(varchar(20),[phone_number2]),&#xA;Convert(varchar(20),[phone_number3]),&#xA;Convert(varchar(12),[line_sequence_number]),&#xA;Convert(varchar(17),[amount_tax]),&#xA;Convert(varchar(24),[upc_code]),&#xA;Convert(varchar(265),[created_from_type]),&#xA;Convert(varchar(20),[line_last_modified]),&#xA;Convert(varchar(265),[fulfilled_received_line_level]),&#xA;Convert(varchar(265),[created_from_document]),&#xA;Convert(varchar(265),[line_unique_key]),&#xA;Convert(varchar(265),[created_from_invoice]),&#xA;Convert(varchar(265),[created_from_so]),&#xA;GETDATE(),&#xA;GETDATE(),&#xA;Convert(varchar(265),[filename])&#xA; From sho_staging.netsuite.sales_daily_line_raw &#xA; where [line_unique_key] not in &#xA; (select [line_unique_key] from sho_staging.netsuite.sales_daily_line_history);"
          SQLTask:TypeConversionMode="None" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Insert into netsuite_sales_daily_payment_history"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{6CA06BB7-5AD4-4997-8505-2C30C0F9B0A0}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Insert into netsuite_sales_daily_payment_history"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="2">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{70e1c0af-32b1-4003-bbb8-6f11bcf67768}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="--*** Insert Into sho_staging.netsuite.sales_daily_payment_history ***&#xA;Insert Into sho_staging.netsuite.sales_daily_payment_history&#xA;(&#xA;[create_date],&#xA;[subsidiary_no_hierarchy],&#xA;[location],&#xA;[eis_number],&#xA;[transaction_type],&#xA;[document_number],&#xA;[sales_document_number],&#xA;[sales_check_number],&#xA;[credit_memo],&#xA;[return_document_number],&#xA;[return_sales_check],&#xA;[payment_method],&#xA;[account],&#xA;[account_grouped],&#xA;[account_type],&#xA;[amount],&#xA;[rec_load_dt],&#xA;[filename]&#xA;) Select &#xA;Convert(varchar(18),[create_date]),&#xA;Convert(varchar(40),[subsidiary_no_hierarchy]),&#xA;Convert(varchar(255),[location]),&#xA;Convert(varchar(10),[eis_number]),&#xA;Convert(varchar(25),[transaction_type]),&#xA;Convert(varchar(10),[document_number]),&#xA;Convert(varchar(10),[sales_document_number]),&#xA;Convert(varchar(50),[sales_check_number]),&#xA;Convert(varchar(10),[credit_memo]),&#xA;Convert(varchar(10),[return_document_number]),&#xA;Convert(varchar(50),[return_sales_check]),&#xA;Convert(varchar(50),[payment_method]),&#xA;Convert(varchar(125),[account]),&#xA;Convert(varchar(125),[account_grouped]),&#xA;Convert(varchar(50),[account_type]),&#xA;Convert(varchar(18),[amount]),&#xA;Convert(datetime,[rec_load_dt]),&#xA;Convert(varchar(255),[filename])&#xA; From sho_staging.netsuite.sales_daily_payment_raw r&#xA;  where NOT EXISTS &#xA; (&#xA;&#x9;SELECT [document_number]&#xA;&#x9;FROM sho_staging.netsuite.sales_daily_payment_history h&#xA;&#x9;WHERE trim(h.document_number) = trim(r.document_number) &#xA;&#x9;&#x9;and trim(h.credit_memo) = trim(r.credit_memo) &#xA;&#x9;&#x9;and trim(h.account) = trim(r.account)&#xA; );" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Insert into netsuite_sales_daily_payment_sales_daily_header_apo_history"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{96633082-5929-4481-84d8-d91da4bce336}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Insert into netsuite_sales_daily_payment_sales_daily_header_apo_history"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{70e1c0af-32b1-4003-bbb8-6f11bcf67768}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="--*** Insert into netsuite_sales_daily_payment_sales_daily_header_apo_history ***&#xA;Insert Into sho_staging.netsuite.sales_daily_apo_history&#xA;(&#xA;[internal_id],&#xA;[date_created],&#xA;[transaction_document_number],&#xA;[sales_check_nummber],&#xA;[promotion],&#xA;[applied_promotion_status],&#xA;[sho_reason_code],&#xA;[sho_pos_reason_code_comment],&#xA;[new_sears_card_application_status],&#xA;[rec_load_dt],&#xA;[rec_upd_dt],&#xA;[filename]&#xA;) &#xA;Select &#xA;Convert(varchar(15),[internal_id]),&#xA;Convert(varchar(15),[date_created]),&#xA;Convert(varchar(15),[transaction_document_number]),&#xA;Convert(varchar(50),[sales_check_nummber]),&#xA;Convert(varchar(50),[promotion]),&#xA;Convert(varchar(50),[applied_promotion_status]),&#xA;Convert(varchar(10),[sho_reason_code]),&#xA;Convert(varchar(350),[sho_pos_reason_code_comment]),&#xA;Convert(varchar(350),[new_sears_card_application_status]),&#xA;GETDATE(),&#xA;GETDATE(),&#xA;Convert(varchar(255),[filename])&#xA; From sho_staging.netsuite.sales_daily_apo_raw r&#xA; WHERE NOT EXISTS &#xA; (&#xA;&#x9;SELECT [transaction_document_number] from sho_staging.netsuite.sales_daily_apo_history h &#xA;&#x9;WHERE &#xA;&#x9;trim(h.[transaction_document_number]) = trim(r.[transaction_document_number])&#xA;&#x9;and trim(h.[sales_check_nummber]) = trim(r.[sales_check_nummber]) &#xA;&#x9;and trim(h.[date_created]) = trim(r.[date_created])&#xA;&#x9;and trim(h.[promotion]) = trim(r.[promotion]) &#xA;&#x9;and trim(h.[applied_promotion_status]) = trim(r.[applied_promotion_status]) &#xA;&#x9;and trim(h.[sho_reason_code]) = trim(r.[sho_reason_code]) &#xA;&#x9;and trim(h.[sho_pos_reason_code_comment]) = trim(r.[sho_pos_reason_code_comment]) &#xA;&#x9;and trim(h.[new_sears_card_application_status]) = trim(r.[new_sears_card_application_status])&#xA;)" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Update netsuite_sales_daily_header_history"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{ae9c84b9-e3cb-49fb-ba60-c6a2d9d476da}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Update netsuite_sales_daily_header_history"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{70e1c0af-32b1-4003-bbb8-6f11bcf67768}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="--*** Update netsuite_sales_daily_header_history ***&#xA;Update sho_staging.netsuite.sales_daily_header_history SET &#xA;[internal_id] = Convert(varchar(8),r.[internal_id]),&#xA;[create_date] = Convert(varchar(28),r.[create_date]),&#xA;[transaction_type] = Convert(varchar(20),r.[transaction_type]),&#xA;[transaction_status] = Convert(varchar(20),r.[transaction_status]),&#xA;[transaction_source] = Convert(varchar(27),r.[transaction_source]),&#xA;[document_number] = Convert(varchar(18),r.[document_number]),&#xA;[sales_check_number] = Convert(varchar(50),r.[sales_check_number]),&#xA;[accounting_unit_nohierarchy] = Convert(varchar(14),r.[accounting_unit_nohierarchy]),&#xA;[store_format_type] = Convert(varchar(14),r.[store_format_type]),&#xA;[region] = Convert(varchar(14),r.[region]),&#xA;[district] = Convert(varchar(14),r.[district]),&#xA;[store] = Convert(varchar(14),r.[store]),&#xA;[location_no_hierarchy] = Convert(varchar(14),r.[location_no_hierarchy]),&#xA;[net_amt] = Convert(varchar(20),r.[net_amt]),&#xA;[total_amount] = Convert(varchar(20),r.[total_amount]),&#xA;[total_tax] = Convert(varchar(20),r.[total_tax]),&#xA;[shipping_amount] = Convert(varchar(20),r.[shipping_amount]),&#xA;[amount] = Convert(varchar(20),r.[amount]),&#xA;[amount_remaining] = Convert(varchar(20),r.[amount_remaining]),&#xA;[gross_profit] = Convert(varchar(20),r.[gross_profit]),&#xA;[comp_store_flag] = Convert(varchar(11),r.[comp_store_flag]),&#xA;[customer_first_name] = Convert(varchar(50),r.[customer_first_name]),&#xA;[customer_last_name] = Convert(varchar(50),r.[customer_last_name]),&#xA;[customer_address_1] = Convert(varchar(100),r.[customer_address_1]),&#xA;[customer_address_2] = Convert(varchar(100),r.[customer_address_2]),&#xA;[customer_city] = Convert(varchar(50),r.[customer_city]),&#xA;[customer_state] = Convert(varchar(12),r.[customer_state]),&#xA;[customer_zip] = Convert(varchar(10),r.[customer_zip]),&#xA;[customer_email_1] = Convert(varchar(100),r.[customer_email_1]),&#xA;[customer_alt__email] = Convert(varchar(100),r.[customer_alt__email]),&#xA;[customer_acc_email] = Convert(varchar(100),r.[customer_acc_email]),&#xA;[customer_shipping_email] = Convert(varchar(100),r.[customer_shipping_email]),&#xA;[customer_phone] = Convert(varchar(20),r.[customer_phone]),&#xA;[customer_mobile] = Convert(varchar(20),r.[customer_mobile]),&#xA;[customer_home_phone] = Convert(varchar(22),r.[customer_home_phone]),&#xA;[date_last_modified] = Convert(varchar(255),r.[date_last_modified]),&#xA;[created_from_type] = Convert(varchar(255),r.[created_from_type]),&#xA;[created_from_document] = Convert(varchar(255),r.[created_from_document]),&#xA;[amount_net_of_tax] = Convert(varchar(20),r.[amount_net_of_tax]),&#xA;[created_from_invoice] = Convert(varchar(255),r.[created_from_invoice]),&#xA;[created_from_so] = Convert(varchar(255),r.[created_from_so]),&#xA;[subtotal] = Convert(varchar(20),r.[subtotal]),&#xA;[discount_amount] = Convert(varchar(20),r.[discount_amount]),&#xA;[shipping_cost] = Convert(varchar(20),r.[shipping_cost]),&#xA;[gift_certificate_amount] = Convert(varchar(20),r.[gift_certificate_amount]),&#xA;[sho_syw_memberid] = Convert(varchar(26),r.[sho_syw_memberid]),&#xA;[sales_rep] = Convert(varchar(41),r.[sales_rep]),&#xA;[rec_load_dt] = Convert(datetime,r.[rec_load_dt]),&#xA;[filename] = Convert(varchar(255),r.[filename])&#xA; From sho_staging.netsuite.sales_daily_header_raw r&#xA; Inner Join sho_staging.netsuite.sales_daily_header_history h&#xA; On trim(r.[document_number]) = trim(h.[document_number]) &#xA; and trim(r.[create_date]) = trim(h.[create_date]);&#xA;"
          SQLTask:TypeConversionMode="None" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Update netsuite_sales_daily_line_history"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{3E504477-39FB-431C-9F1E-4384BB5863C7}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Update netsuite_sales_daily_line_history"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="3">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{70e1c0af-32b1-4003-bbb8-6f11bcf67768}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="--*** Update  [netsuite].[sales_daily_line_history]  from existing records in [sho_staging].[netsuite].[sales_daily_line_raw] ***&#xA;update [netsuite].[sales_daily_line_history] &#xA;set &#xA;[create_date] = Trim(r.[create_date]), &#xA;[transaction_type] = Trim(r.[transaction_type]), &#xA;[transaction_status] = Trim(r.[transaction_status]), &#xA;[transaction_source] = Trim(r.[transaction_source]), &#xA;[document_number] = Trim(r.[document_number]), &#xA;[sales_check_number] = Trim(r.[sales_check_number]), &#xA;[accounting_unit] = Trim(r.[accounting_unit]), &#xA;[store_format_type] = Trim(r.[store_format_type]), &#xA;[region] = Trim(r.[region]), &#xA;[district] = Trim(r.[district]), &#xA;[store] = Trim(r.[store]), &#xA;[location_no_hierarchy] = Trim(r.[location_no_hierarchy]), &#xA;[category] = Trim(r.[category]), &#xA;[division] = Trim(r.[division]), &#xA;[line] = Trim(r.[line]), &#xA;[subline] = Trim(r.[subline]), &#xA;[class] = Trim(r.[class]), &#xA;[item_name] = Trim(r.[item_name]), &#xA;[item_description_display_name] = Trim(r.[item_description_display_name]), &#xA;[item_designation] = Trim(r.[item_designation]), &#xA;[sku_number] = Trim(r.[sku_number]), &#xA;[sho_item_type] = Trim(r.[sho_item_type]), &#xA;[brand] = Trim(r.[brand]), &#xA;[available_pa] = Trim(r.[available_pa]), &#xA;[bulk_sales] = Trim(r.[bulk_sales]), &#xA;[net_amt] = Trim(r.[net_amt]), &#xA;[net_qty] = Trim(r.[net_qty]), &#xA;[item_average_cost] = Trim(r.[item_average_cost]), &#xA;[list_price] = Trim(r.[list_price]), &#xA;[regular_price] = Trim(r.[regular_price]), &#xA;[cadence_price_3h] = Trim(r.[cadence_price_3h]), &#xA;[cadance_price_outlet] = Trim(r.[cadance_price_outlet]), &#xA;[sold_price] = Trim(r.[sold_price]), &#xA;[gross_profit] = Trim(r.[gross_profit]), &#xA;[comp_store_flag] = Trim(r.[comp_store_flag]), &#xA;[fulfillment_method] = Trim(r.[fulfillment_method]), &#xA;[fulfillment_option_selected] = Trim(r.[fulfillment_option_selected]), &#xA;[first_name] = Trim(r.[first_name]), &#xA;[last_name] = Trim(r.[last_name]), &#xA;[address_1] = Trim(r.[address_1]), &#xA;[address_2] = Trim(r.[address_2]), &#xA;[city] = Trim(r.[city]), &#xA;[state] = Trim(r.[state]), &#xA;[zip] = Trim(r.[zip]), &#xA;[email_1] = Trim(r.[email_1]), &#xA;[email_2] = Trim(r.[email_2]), &#xA;[email_3] = Trim(r.[email_3]), &#xA;[email_4] = Trim(r.[email_4]), &#xA;[phone_number1] = Trim(r.[phone_number1]), &#xA;[phone_number2] = Trim(r.[phone_number2]), &#xA;[phone_number3] = Trim(r.[phone_number3]), &#xA;[line_sequence_number] = Trim(r.[line_sequence_number]), &#xA;[amount_tax] = Trim(r.[amount_tax]), &#xA;[upc_code] = Trim(r.[upc_code]), &#xA;[created_from_type] = Trim(r.[created_from_type]), &#xA;[line_last_modified] = Trim(r.[line_last_modified]), &#xA;[fulfilled_received_line_level] = Trim(r.[fulfilled_received_line_level]), &#xA;[created_from_document] = Trim(r.[created_from_document]), &#xA;[line_unique_key] = Trim(r.[line_unique_key]), &#xA;[created_from_invoice] = Trim(r.[created_from_invoice]), &#xA;[created_from_so] = Trim(r.[created_from_so]), &#xA;[rec_upd_dt] = GETDATE(), &#xA;[filename] = Trim(r.[filename]) &#xA;from [netsuite].[sales_daily_line_raw] r &#xA;INNER JOIN [sho_staging].[netsuite].[sales_daily_line_history] h&#xA;on r.line_unique_key = h.line_unique_key;"
          SQLTask:TypeConversionMode="None" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Update netsuite_sales_daily_payment_history"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{B8FF860E-F590-4383-9865-256636F8CE3C}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Update netsuite_sales_daily_payment_history"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="2">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{70e1c0af-32b1-4003-bbb8-6f11bcf67768}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="--*** Update sho_staging.netsuite.sales_daily_payment_history***&#xA;Update sho_staging.netsuite.sales_daily_payment_history SET &#xA;[create_date] = Convert(varchar(18),r.[create_date]),&#xA;[subsidiary_no_hierarchy] = Convert(varchar(40),r.[subsidiary_no_hierarchy]),&#xA;[location] = Convert(varchar(255),r.[location]),&#xA;[eis_number] = Convert(varchar(10),r.[eis_number]),&#xA;[transaction_type] = Convert(varchar(25),r.[transaction_type]),&#xA;[document_number] = Convert(varchar(10),r.[document_number]),&#xA;[sales_document_number] = Convert(varchar(10),r.[sales_document_number]),&#xA;[sales_check_number] = Convert(varchar(50),r.[sales_check_number]),&#xA;[credit_memo] = Convert(varchar(10),r.[credit_memo]),&#xA;[return_document_number] = Convert(varchar(10),r.[return_document_number]),&#xA;[return_sales_check] = Convert(varchar(50),r.[return_sales_check]),&#xA;[payment_method] = Convert(varchar(50),r.[payment_method]),&#xA;[account] = Convert(varchar(125),r.[account]),&#xA;[account_grouped] = Convert(varchar(125),r.[account_grouped]),&#xA;[account_type] = Convert(varchar(50),r.[account_type]),&#xA;[amount] = Convert(varchar(18),r.[amount]),&#xA;[filename] = Convert(varchar(255),r.[filename])&#xA; From sho_staging.netsuite.sales_daily_payment_raw r&#xA; Inner Join sho_staging.netsuite.sales_daily_payment_history h&#xA; On trim(r.document_number) = trim(h.document_number) &#xA; and trim(r.credit_memo) = trim(h.credit_memo) &#xA; and trim(r.account) = trim(h.account);" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Update netsuite_sales_daily_payment_sales_daily_header_apo_history"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{75000522-2533-478a-bdaf-fff7d32c6306}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Update netsuite_sales_daily_payment_sales_daily_header_apo_history"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2017 RC1; © 2017 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{70e1c0af-32b1-4003-bbb8-6f11bcf67768}"
          SQLTask:BypassPrepare="False"
          SQLTask:SqlStatementSource="--*** Update netsuite_sales_daily_payment_sales_daily_header_apo_history***&#xA;Update sho_staging.netsuite.sales_daily_apo_history SET &#xA;[internal_id] = Convert(varchar(15),r.[internal_id]),&#xA;[date_created] = Convert(varchar(15),r.[date_created]),&#xA;[transaction_document_number] = Convert(varchar(15),r.[transaction_document_number]),&#xA;[sales_check_nummber] = Convert(varchar(50),r.[sales_check_nummber]),&#xA;[promotion] = Convert(varchar(50),r.[promotion]),&#xA;[applied_promotion_status] = Convert(varchar(50),r.[applied_promotion_status]),&#xA;[sho_reason_code] = Convert(varchar(10),r.[sho_reason_code]),&#xA;[sho_pos_reason_code_comment] = Convert(varchar(350),r.[sho_pos_reason_code_comment]),&#xA;[new_sears_card_application_status] = Convert(varchar(350),r.[new_sears_card_application_status]),&#xA;[rec_upd_dt] = GETDATE(),&#xA;[filename] = Convert(varchar(255),r.[filename])&#xA; From sho_staging.netsuite.sales_daily_apo_raw r&#xA; Inner Join sho_staging.netsuite.sales_daily_apo_history h&#xA; On trim(h.[transaction_document_number]) = trim(r.[transaction_document_number])&#xA;&#x9;and trim(h.[sales_check_nummber]) = trim(r.[sales_check_nummber]) &#xA;&#x9;and trim(h.[date_created]) = trim(r.[date_created])&#xA;&#x9;and trim(h.[promotion]) = trim(r.[promotion]) &#xA;&#x9;and trim(h.[applied_promotion_status]) = trim(r.[applied_promotion_status]) &#xA;&#x9;and trim(h.[sho_reason_code]) = trim(r.[sho_reason_code]) &#xA;&#x9;and trim(h.[sho_pos_reason_code_comment]) = trim(r.[sho_pos_reason_code_comment]) &#xA;&#x9;and trim(h.[new_sears_card_application_status]) = trim(r.[new_sears_card_application_status]);" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{C140D2CB-DEA8-4B8D-9F03-9BCB4CC2D87A}"
      DTS:From="Package\Update netsuite_sales_daily_payment_history"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Insert into netsuite_sales_daily_payment_history" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{CB556C3C-A69B-43AF-B31E-1737E1B47FB4}"
      DTS:From="Package\Update netsuite_sales_daily_line_history"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Insert Into netsuite_sales_daily_line_history" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{B1CB6A4C-B9B3-4A06-A459-5C0216189E4D}"
      DTS:From="Package\Update netsuite_sales_daily_payment_sales_daily_header_apo_history"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\Insert into netsuite_sales_daily_payment_sales_daily_header_apo_history" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{3B94C7A7-0505-4A3F-9AC7-4113D6C6E18D}"
      DTS:From="Package\Update netsuite_sales_daily_header_history"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\Insert Into netsuite_sales_daily_header_history" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="286,42"
          Id="Package\Insert Into netsuite_sales_daily_line_history"
          TopLeft="141,161" />
        <NodeLayout
          Size="309,42"
          Id="Package\Insert into netsuite_sales_daily_payment_history"
          TopLeft="105,346" />
        <NodeLayout
          Size="270,42"
          Id="Package\Update netsuite_sales_daily_line_history"
          TopLeft="143,88" />
        <NodeLayout
          Size="294,42"
          Id="Package\Update netsuite_sales_daily_payment_history"
          TopLeft="107,259" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="281,130">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,31"
              Start="0,0"
              End="0,23.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,23.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="256.75,301">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,45"
              Start="0,0"
              End="0,37.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,37.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="412,42"
          Id="Package\Update netsuite_sales_daily_payment_sales_daily_header_apo_history"
          TopLeft="497,241" />
        <NodeLayout
          Size="427,42"
          Id="Package\Insert into netsuite_sales_daily_payment_sales_daily_header_apo_history"
          TopLeft="495,331" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="705.75,283">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,48"
              Start="0,0"
              End="0,40.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,40.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="286,42"
          Id="Package\Update netsuite_sales_daily_header_history"
          TopLeft="550,84" />
        <NodeLayout
          Size="302,42"
          Id="Package\Insert Into netsuite_sales_daily_header_history"
          TopLeft="550,160" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="693,126">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="8,34"
              Start="0,0"
              End="8,26.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,13" />
                  <mssgle:CubicBezierSegment
                    Point1="0,13"
                    Point2="0,17"
                    Point3="4,17" />
                  <mssgle:LineSegment
                    End="4,17" />
                  <mssgle:CubicBezierSegment
                    Point1="4,17"
                    Point2="8,17"
                    Point3="8,21" />
                  <mssgle:LineSegment
                    End="8,26.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>